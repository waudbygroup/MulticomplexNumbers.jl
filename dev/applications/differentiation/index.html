<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Numerical Differentiation · MulticomplexNumbers.jl</title><meta name="title" content="Numerical Differentiation · MulticomplexNumbers.jl"/><meta property="og:title" content="Numerical Differentiation · MulticomplexNumbers.jl"/><meta property="twitter:title" content="Numerical Differentiation · MulticomplexNumbers.jl"/><meta name="description" content="Documentation for MulticomplexNumbers.jl."/><meta property="og:description" content="Documentation for MulticomplexNumbers.jl."/><meta property="twitter:description" content="Documentation for MulticomplexNumbers.jl."/><meta property="og:url" content="https://waudbygroup.github.io/MulticomplexNumbers.jl/stable/applications/differentiation/"/><meta property="twitter:url" content="https://waudbygroup.github.io/MulticomplexNumbers.jl/stable/applications/differentiation/"/><link rel="canonical" href="https://waudbygroup.github.io/MulticomplexNumbers.jl/stable/applications/differentiation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MulticomplexNumbers.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../background/">Background</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../guide/creating/">Creating Numbers</a></li><li><a class="tocitem" href="../../guide/arithmetic/">Arithmetic Operations</a></li><li><a class="tocitem" href="../../guide/components/">Accessing Components</a></li><li><a class="tocitem" href="../../guide/fft/">FFT Operations</a></li></ul></li><li><span class="tocitem">Applications</span><ul><li><a class="tocitem" href="../nmr/">NMR Spectroscopy</a></li><li class="is-active"><a class="tocitem" href>Numerical Differentiation</a><ul class="internal"><li><a class="tocitem" href="#The-Multicomplex-Step-Method"><span>The Multicomplex Step Method</span></a></li><li><a class="tocitem" href="#Background:-The-Problem-with-Finite-Differences"><span>Background: The Problem with Finite Differences</span></a></li><li><a class="tocitem" href="#The-Complex-Step-Method"><span>The Complex Step Method</span></a></li><li><a class="tocitem" href="#First-Derivatives-with-im1"><span>First Derivatives with <code>im1</code></span></a></li><li><a class="tocitem" href="#Second-Derivatives-with-im1-and-im2"><span>Second Derivatives with <code>im1</code> and <code>im2</code></span></a></li><li><a class="tocitem" href="#Third-Derivatives-with-im1,-im2,-and-im3"><span>Third Derivatives with <code>im1</code>, <code>im2</code>, and <code>im3</code></span></a></li><li><a class="tocitem" href="#Practical-Derivative-Helper-Function"><span>Practical Derivative Helper Function</span></a></li><li><a class="tocitem" href="#Applications"><span>Applications</span></a></li><li><a class="tocitem" href="#Practical-Tips"><span>Practical Tips</span></a></li><li><a class="tocitem" href="#Limitations"><span>Limitations</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Applications</a></li><li class="is-active"><a href>Numerical Differentiation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Numerical Differentiation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/waudbygroup/MulticomplexNumbers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/waudbygroup/MulticomplexNumbers.jl/blob/main/docs/src/applications/differentiation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="differentiation-applications"><a class="docs-heading-anchor" href="#differentiation-applications">Numerical Differentiation</a><a id="differentiation-applications-1"></a><a class="docs-heading-anchor-permalink" href="#differentiation-applications" title="Permalink"></a></h1><p>This tutorial demonstrates how to use the multicomplex step method for high-precision numerical differentiation.</p><hr/><h2 id="The-Multicomplex-Step-Method"><a class="docs-heading-anchor" href="#The-Multicomplex-Step-Method">The Multicomplex Step Method</a><a id="The-Multicomplex-Step-Method-1"></a><a class="docs-heading-anchor-permalink" href="#The-Multicomplex-Step-Method" title="Permalink"></a></h2><p>The multicomplex step method extends the complex step derivative to compute higher-order derivatives with machine precision accuracy, avoiding the subtractive cancellation errors that plague finite difference methods.</p><hr/><h2 id="Background:-The-Problem-with-Finite-Differences"><a class="docs-heading-anchor" href="#Background:-The-Problem-with-Finite-Differences">Background: The Problem with Finite Differences</a><a id="Background:-The-Problem-with-Finite-Differences-1"></a><a class="docs-heading-anchor-permalink" href="#Background:-The-Problem-with-Finite-Differences" title="Permalink"></a></h2><p>Traditional numerical differentiation uses finite differences:</p><p class="math-container">\[f&#39;(x) \approx \frac{f(x+h) - f(x)}{h}\]</p><p>This suffers from a fundamental trade-off:</p><ul><li><strong>Large h</strong>: Truncation error dominates (formula is only approximate)</li><li><strong>Small h</strong>: Roundoff error dominates (subtractive cancellation in <code>f(x+h) - f(x)</code>)</li></ul><p>The optimal <code>h</code> is typically around <code>√ε ≈ 10⁻⁸</code> for Float64, limiting accuracy to about 8 digits.</p><hr/><h2 id="The-Complex-Step-Method"><a class="docs-heading-anchor" href="#The-Complex-Step-Method">The Complex Step Method</a><a id="The-Complex-Step-Method-1"></a><a class="docs-heading-anchor-permalink" href="#The-Complex-Step-Method" title="Permalink"></a></h2><p>For an analytic function <code>f</code>, we have the Taylor expansion:</p><p class="math-container">\[f(x + ih) = f(x) + ih \cdot f&#39;(x) - \frac{h^2}{2}f&#39;&#39;(x) - \frac{ih^3}{6}f&#39;&#39;&#39;(x) + ...\]</p><p>Taking the imaginary part:</p><p class="math-container">\[\text{Im}[f(x + ih)] = h \cdot f&#39;(x) + O(h^3)\]</p><p>Thus:</p><p class="math-container">\[f&#39;(x) \approx \frac{\text{Im}[f(x + ih)]}{h}\]</p><p>Since we&#39;re not computing a difference, there&#39;s <strong>no subtractive cancellation</strong>! We can use arbitrarily small <code>h</code>, giving nearly machine-precision derivatives.</p><hr/><h2 id="First-Derivatives-with-im1"><a class="docs-heading-anchor" href="#First-Derivatives-with-im1">First Derivatives with <code>im1</code></a><a id="First-Derivatives-with-im1-1"></a><a class="docs-heading-anchor-permalink" href="#First-Derivatives-with-im1" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MulticomplexNumbers</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Define a test function
       f(x) = sin(x) * exp(-x^2)</code><code class="nohighlight hljs ansi" style="display:block;">f (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Compute derivative at x = 0.5
       x = 0.5</code><code class="nohighlight hljs ansi" style="display:block;">0.5</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; h = 1e-100  # Extremely small step - impossible with finite differences!</code><code class="nohighlight hljs ansi" style="display:block;">1.0e-100</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Evaluate f at x + h*im1
       result = f(x + h*im1)</code><code class="nohighlight hljs ansi" style="display:block;">0.37337698488938337 + 3.100850015206486e-101*im1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Extract derivative from imaginary part
       f_prime = imag(result) / h</code><code class="nohighlight hljs ansi" style="display:block;">0.3100850015206486</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Compute exact derivative: f&#39;(x) = cos(x)*exp(-x²) - 2x*sin(x)*exp(-x²)
       exact = cos(x)*exp(-x^2) - 2x*sin(x)*exp(-x^2)</code><code class="nohighlight hljs ansi" style="display:block;">0.3100850015206486</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Error
       abs(f_prime - exact)</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code></pre><p>The error is at the level of machine epsilon!</p><hr/><h2 id="Second-Derivatives-with-im1-and-im2"><a class="docs-heading-anchor" href="#Second-Derivatives-with-im1-and-im2">Second Derivatives with <code>im1</code> and <code>im2</code></a><a id="Second-Derivatives-with-im1-and-im2-1"></a><a class="docs-heading-anchor-permalink" href="#Second-Derivatives-with-im1-and-im2" title="Permalink"></a></h2><p>For second derivatives, we use bicomplex numbers (<code>im1</code> and <code>im2</code>):</p><p class="math-container">\[f&#39;&#39;(x) \approx \frac{\text{component}_{i_1 i_2}[f(x + h \cdot i_1 + h \cdot i_2)]}{h^2}\]</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MulticomplexNumbers</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Compute second derivative of f(x) = x^4 at x = 2
       # Exact answer: f&#39;&#39;(x) = 12x² = 48
       
       x = 2.0</code><code class="nohighlight hljs ansi" style="display:block;">2.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; h = 1e-50</code><code class="nohighlight hljs ansi" style="display:block;">1.0e-50</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Evaluate at x + h*im1 + h*im2
       result = (x + h*im1 + h*im2)^4</code><code class="nohighlight hljs ansi" style="display:block;">(16.0 + 3.2e-49*im1) + (3.2e-49 + 4.8e-99*im1)*im2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # The i₁i₂ component is at index 4: [1, i₁, i₂, i₁i₂]
       second_derivative = component(result, 4) / h^2</code><code class="nohighlight hljs ansi" style="display:block;">48.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Exact value
       exact = 12 * x^2</code><code class="nohighlight hljs ansi" style="display:block;">48.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; abs(second_derivative - exact)</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code></pre><hr/><h2 id="Third-Derivatives-with-im1,-im2,-and-im3"><a class="docs-heading-anchor" href="#Third-Derivatives-with-im1,-im2,-and-im3">Third Derivatives with <code>im1</code>, <code>im2</code>, and <code>im3</code></a><a id="Third-Derivatives-with-im1,-im2,-and-im3-1"></a><a class="docs-heading-anchor-permalink" href="#Third-Derivatives-with-im1,-im2,-and-im3" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MulticomplexNumbers</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Compute third derivative of f(x) = x^5 at x = 1
       # Exact answer: f&#39;&#39;&#39;(x) = 60x² = 60
       
       x = 1.0</code><code class="nohighlight hljs ansi" style="display:block;">1.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; h = 1e-30</code><code class="nohighlight hljs ansi" style="display:block;">1.0e-30</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Evaluate at x + h*im1 + h*im2 + h*im3
       result = (x + h*im1 + h*im2 + h*im3)^5</code><code class="nohighlight hljs ansi" style="display:block;">((1.0 + 5.0000000000000004e-30*im1) + (5.0000000000000004e-30 + 2.0e-59*im1)*im2) + ((5.0000000000000004e-30 + 2.0e-59*im1) + (2.0e-59 + 6.000000000000001e-89*im1)*im2)*im3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # The i₁i₂i₃ component is at index 8
       third_derivative = component(result, 8) / h^3</code><code class="nohighlight hljs ansi" style="display:block;">60.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; exact = 60.0</code><code class="nohighlight hljs ansi" style="display:block;">60.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; abs(third_derivative - exact)</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code></pre><hr/><h2 id="Practical-Derivative-Helper-Function"><a class="docs-heading-anchor" href="#Practical-Derivative-Helper-Function">Practical Derivative Helper Function</a><a id="Practical-Derivative-Helper-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Practical-Derivative-Helper-Function" title="Permalink"></a></h2><p>Here&#39;s a convenient wrapper function:</p><pre><code class="language-julia hljs">using MulticomplexNumbers

&quot;&quot;&quot;
    derivative(f, x, n=1; h=1e-50)

Compute the n-th derivative of f at x using multicomplex step method.

# Arguments
- `f`: Function to differentiate
- `x`: Point at which to evaluate the derivative
- `n`: Order of derivative (1-4 supported)
- `h`: Step size (default: 1e-50)

# Returns
The n-th derivative of f at x

# Examples</code></pre><p>julia f(x) = sin(x) derivative(f, 1.0, 1)  # First derivative at x=1 derivative(f, 1.0, 2)  # Second derivative at x=1</p><pre><code class="nohighlight hljs">&quot;&quot;&quot;
function derivative(f, x::Real, n::Int=1; h::Real=1e-50)
    if n &lt; 1
        return f(x)
    elseif n == 1
        result = f(x + h*im1)
        return imag(result) / h
    elseif n == 2
        result = f(x + h*im1 + h*im2)
        return component(result, 4) / h^2
    elseif n == 3
        result = f(x + h*im1 + h*im2 + h*im3)
        return component(result, 8) / h^3
    elseif n == 4
        result = f(x + h*im1 + h*im2 + h*im3 + h*im4)
        return component(result, 16) / h^4
    else
        error(&quot;Derivatives of order &gt; 4 not implemented in this example&quot;)
    end
end

# Test it
f(x) = sin(x)
x = 1.0

derivative(f, x, 1)  # f&#39;(1) = cos(1) ≈ 0.5403
derivative(f, x, 2)  # f&#39;&#39;(1) = -sin(1) ≈ -0.8415
derivative(f, x, 3)  # f&#39;&#39;&#39;(1) = -cos(1) ≈ -0.5403
derivative(f, x, 4)  # f&#39;&#39;&#39;&#39;(1) = sin(1) ≈ 0.8415</code></pre><hr/><h2 id="Applications"><a class="docs-heading-anchor" href="#Applications">Applications</a><a id="Applications-1"></a><a class="docs-heading-anchor-permalink" href="#Applications" title="Permalink"></a></h2><h3 id="Numerical-Optimization"><a class="docs-heading-anchor" href="#Numerical-Optimization">Numerical Optimization</a><a id="Numerical-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Optimization" title="Permalink"></a></h3><p>Compute exact gradients and Hessians:</p><pre><code class="language-julia hljs">using MulticomplexNumbers

# Rosenbrock function
rosenbrock(x, y) = (1 - x)^2 + 100 * (y - x^2)^2

# Gradient at (0.5, 0.5)
x, y = 0.5, 0.5
h = 1e-50

# Partial derivatives
∂f_∂x = imag(rosenbrock(x + h*im1, y)) / h
∂f_∂y = imag(rosenbrock(x, y + h*im1)) / h

println(&quot;Gradient: ($(∂f_∂x), $(∂f_∂y))&quot;)

# Second partial: ∂²f/∂x²
∂²f_∂x² = component(rosenbrock(x + h*im1 + h*im2, y), 4) / h^2</code></pre><h3 id="Sensitivity-Analysis"><a class="docs-heading-anchor" href="#Sensitivity-Analysis">Sensitivity Analysis</a><a id="Sensitivity-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-Analysis" title="Permalink"></a></h3><p>Compute how outputs change with respect to parameters:</p><pre><code class="language-julia hljs">using MulticomplexNumbers

# Model: exponential decay
function decay_model(t, A, k)
    return A * exp(-k * t)
end

# Sensitivity of output to amplitude A at t=2.0
t = 2.0
A = 1.0
k = 0.5
h = 1e-50

sensitivity_A = imag(decay_model(t, A + h*im1, k)) / h
sensitivity_k = imag(decay_model(t, A, k + h*im1)) / h

println(&quot;Sensitivity to A: $(sensitivity_A)&quot;)
println(&quot;Sensitivity to k: $(sensitivity_k)&quot;)</code></pre><h3 id="Root-Finding-(Newton&#39;s-Method)"><a class="docs-heading-anchor" href="#Root-Finding-(Newton&#39;s-Method)">Root Finding (Newton&#39;s Method)</a><a id="Root-Finding-(Newton&#39;s-Method)-1"></a><a class="docs-heading-anchor-permalink" href="#Root-Finding-(Newton&#39;s-Method)" title="Permalink"></a></h3><p>Newton&#39;s method with exact derivatives:</p><pre><code class="language-julia hljs">using MulticomplexNumbers

&quot;&quot;&quot;Newton&#39;s method using multicomplex derivatives.&quot;&quot;&quot;
function newton(f, x0; tol=1e-10, maxiter=100)
    x = x0
    h = 1e-100

    for i in 1:maxiter
        fx = f(x)
        fpx = imag(f(x + h*im1)) / h

        if abs(fx) &lt; tol
            return x
        end

        x = x - fx / fpx
    end

    error(&quot;Newton&#39;s method did not converge&quot;)
end

# Find root of f(x) = x^3 - 2x - 5
f(x) = x^3 - 2x - 5
root = newton(f, 2.0)
println(&quot;Root: $(root)&quot;)
println(&quot;Verification f(root) = $(f(root))&quot;)</code></pre><hr/><h2 id="Practical-Tips"><a class="docs-heading-anchor" href="#Practical-Tips">Practical Tips</a><a id="Practical-Tips-1"></a><a class="docs-heading-anchor-permalink" href="#Practical-Tips" title="Permalink"></a></h2><ol><li><p><strong>Step size</strong>: Use <code>h ≈ 10⁻⁵⁰/n</code> for the n-th derivative. Smaller is generally better (but not required for convergence).</p></li><li><p><strong>Component indices</strong>: For an n-th derivative, extract component <code>2^n</code> from an order-n multicomplex number:</p><ul><li>1st derivative: component 2 (index 2) from order 1</li><li>2nd derivative: component 4 (index 4) from order 2</li><li>3rd derivative: component 8 (index 8) from order 3</li><li>4th derivative: component 16 (index 16) from order 4</li></ul></li><li><p><strong>Computational cost</strong>: Storage and computation scale as <code>2^n</code> for the n-th derivative. For orders above ~10, this becomes expensive.</p></li><li><p><strong>Function requirements</strong>: Your function must:</p><ul><li>Accept multicomplex arguments</li><li>Use operations that work on them (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>, <code>exp</code>, <code>log</code>, <code>sqrt</code>, etc.)</li><li>Avoid type-specific operations or branching based on exact values</li></ul></li><li><p><strong>Comparison with AD</strong>:</p><ul><li>Multicomplex is simpler to implement (just change the input type)</li><li>AD (via ForwardDiff.jl) is more efficient for gradients of functions ℝⁿ → ℝ</li><li>Multicomplex excels for high-order derivatives of scalar functions</li></ul></li></ol><hr/><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><ol><li><p><strong>Analytic functions only</strong>: The function must be complex-analytic (or at least extend to multicomplex arguments)</p></li><li><p><strong>No branching</strong>: Avoid conditionals that depend on exact values:</p><pre><code class="language-julia hljs"># Bad: branching on exact value
f(x) = x &gt; 0 ? sqrt(x) : 0

# Good: smooth approximation
f(x) = x &gt; 0 ? sqrt(x) : sqrt(x^2 + 1e-10) - 1e-5</code></pre></li><li><p><strong>Computational cost</strong>: Each order doubles the component count and computational cost</p></li><li><p><strong>Very high orders</strong>: Beyond order ~6, consider other methods (symbolic differentiation, AD with nested dual numbers, etc.)</p></li></ol><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li><strong>Complex Step Approximation</strong>: <a href="https://nhigham.com/2020/10/06/what-is-the-complex-step-approximation/">Nick Higham&#39;s blog</a></li><li><strong>Original Method</strong>: Lantoine, G., Russell, R. P., Dargent, T. (2012). &quot;Using Multicomplex Variables for Automatic Computation of High-order Derivatives.&quot; ACM TOMS 38(3):16.</li><li><strong>NIST Report</strong>: Bell, I. H., Deiters, U. K. (2021). &quot;Precise Numerical Differentiation of Thermodynamic Functions with Multicomplex Variables.&quot; <a href="https://nvlpubs.nist.gov/nistpubs/jres/126/jres.126.033.pdf">NIST J. Res. 126:033</a></li></ul><hr/><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><strong><a href="../../guide/creating/#creating">Creating Numbers</a></strong>: How to create multicomplex numbers</li><li><strong><a href="../../guide/arithmetic/#arithmetic">Arithmetic Operations</a></strong>: Mathematical operations</li><li><strong><a href="../../examples/#Examples">Examples</a></strong>: Quick code snippets</li><li><strong><a href="../../api/#API-Reference">API Reference</a></strong>: Complete function documentation</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nmr/">« NMR Spectroscopy</a><a class="docs-footer-nextpage" href="../../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 2 January 2026 15:59">Friday 2 January 2026</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
